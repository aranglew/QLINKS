function AddRow(n,t,i){var o=$("#SearchString").val(),s=$("#pages").val(),r=i,u=t,f=n,e,h='<form action="/Home/AddUser?sortOrder='+e+"&=currentFilter"+u+"&searchString="+f+"&Page="+r+'" method="get">';$("#UserTable > tbody:first-child").append('<form action="./Home/AddUser?sortOrder='+e+"&=currentFilter"+u+"&searchString="+f+"&Page="+r+'" method="get"><tr><td><input id="txtusername" type="textbox" value="" placeholder = "e.g aranglew"/><\/td><td><input id="txtdata" type="textbox" value="" /><\/td><td><input id="txtlocation" type="textbox" value="" /><\/td><td><input id="txtdivision" type="textbox" value="" /><\/td><td><input id="txtuseremail" type="textbox" value=""/> <\/td><td><input id="txtvimvisible" type="checkbox" /><\/td><td><input id="txtvimdelegate" type="checkbox"  /><\/td><td><input id="txtvimaccess" type="checkbox"  /><\/td><td><input title="save new user" class="button" value="Save" type="Submit"/><\/form><\/td><\/tr>')}function showhide(n){var t=document.getElementById(n);t.style.display=t.style.display==="block"?"none":"block"}function ShowUserDetails(n,t){var i=$("#myModal"),r;n===2?(i.find(".modal-title").text("New User "),$("#modaluser").prop("disabled",!1),$("#modaluser2").prop("disabled",!1),$("#savebutton").show(),$("#CopyUserid").hide(),$("#CopyUserform").hide(),GetDivisionList(""),$("#username").val(""),$("#userdata").val(""),$("#division").val(""),$("#location").val(""),$("#topicid").val(""),$("#topicuserid").val(""),$("#email").val(""),$("#initials").val(""),$("#phone").val(""),$("#Access").val(""),$("#Accessa").val(""),$("#vimsaccess").val(""),$("#vimsdelegate").prop("checked",!1),$("#vimsvisible").prop("checked",!1)):(r=t.dataset.user,GetDetailbyUser(r,function(t){n===1&&(i.find(".modal-title").text("Editing user: "+t[0].Data),$("#modaluser").prop("disabled",!1),$("#modaluser2").prop("disabled",!1),$("#savebutton").show(),$("#CopyUserid").show(),$("#CopyUserform").show(),GetUserList("",t[0].Division));n===0&&(i.find(".modal-title").text("Details for: "+t[0].Data),$("#modaluser").prop("disabled",!0),$("#modaluser2").prop("disabled",!0),$("#savebutton").hide(),$("#CopyUserid").hide(),$("#CopyUserform").hide());GetDivisionList(t[0].Division);$("#username").val(t[0].UserName);$("#userdata").val(t[0].Data);$("#division").val(t[0].Division);$("#location").val(t[0].Location);$("#topicid").val(t[0].TopicID);$("#topicuserid").val(t[0].TopicUserID);$("#email").val(t[0].UserEmail);$("#initials").val(t[0].UserInitials);$("#phone").val(t[0].UserPhone);$("#Access").val(t[0].Access);$("#Accessa").val(t[0].AccessA);$("#vimsaccess").val(t[0].VimsAccess);$("#vimsdelegate").prop("checked",t[0].VimsDelegate);$("#vimsvisible").prop("checked",t[0].VimsVisible)}))}function SaveUser(){var n={username:$("#username").val(),data:$("#userdata").val(),division:$("#division").val(),location:$("#location").val(),TopicID:$("#topicid").val(),TopicUserID:$("#topicuserid").val(),UserEmail:$("#email").val(),UserInitials:$("#initials").val(),UserPhone:$("#phone").val(),Access:$("#Access").val(),Accessa:$("#Accessa").val(),vimsaccess:$("#vimsaccess").val(),vimsdelegate:$("#vimsdelegate").prop("checked"),vimsvisible:$("#vimsvisible").prop("checked")};n.TopicUserID===""||n.TopicUserID===""?Newuser(n):EditUser(n)}function GetDivisionList(n){$.ajax({url:"./Home/GetDivisionList/",type:"GET",dataType:"json",contentType:"application/json;",success:function(t){var r="",u,i;for(n.length<1&&(r+='<option value ="Select a Division" disabled selected> Select Division <\/option>'),u=!1,i=0;i<t.length;i++)t[i].DivisionName===n?(r+='<option value ="'+t[i].DivisionName+'" selected>'+t[i].DivisionName+"<\/option>",u=!0):r+='<option value ="'+t[i].DivisionName+'">'+t[i].DivisionName+"<\/option>";$("#division").empty();$("#division").append(r)}})}function GetUserList(n,t){$.ajax({url:"./Home/GetUserList/",type:"GET",data:{division:t},dataType:"json",contentType:"application/json;",success:function(t){for(var r="",u=!1,i=0;i<t.length;i++)t[i].UserName===n?u=!0:r+='<option value ="'+t[i]+'">'+t[i]+"<\/option>";$("#CopyTousername").empty();$("#CopyTousername").append(r);u||$("#CopyTousername").val("empty")}})}function Newuser(n){n.TopicUserID=1;n.TopicID=0;$.ajax({url:"./Home/AddUserAjax/",type:"POST",contentType:"application/json;",data:JSON.stringify({New_user:n}),success:function(){$("#myModal").modal("hide");$("#SearchString").val(n.UserName);window.location.reload()},error:function(){alert("Error saving user data")}})}function GetDetailbyUser(n,t){$.ajax({url:"./Home/DetailsbyUser",type:"GET",dataType:"json",contentType:"application/json;",data:{UserName:n},success:function(n){t(n)},error:function(){alert("Error getting user data")}})}function EditUser(n){$.ajax({url:"./Home/EditUser/",type:"POST",contentType:"application/json;",data:JSON.stringify({Edit_user:n}),success:function(){$("#myModal").modal("hide");window.location.reload()},error:function(){alert("Error saving user data")}})}function GetNextRow(n){var f=["TID","Topic","Access","username","Detail"],r=$("<tr/>"),t,u;for(t in n)jQuery.inArray(t,f)<0&&(u=$("<td/>").attr("width",2).append($("<input/>",{id:t+i,value:n[t]})),r.append(u));return r.html()}function GetMenuOptionsbyUser(n,t){$.ajax({url:"./Home/Details/",type:"GET",dataType:"json",contentType:"application/json;",data:{SearchParam:n,CurrentPage:1,CurrentFilter:n},success:function(n){t(n)},error:function(){alert("Error getting user data")}})}function SaveMenuOption(){var n={TopicID:$("#TopicIDOpt").val(),Topic:$("#TopicOpt").val(),Description:$("#DescriptionOpt").val(),Type:$("#TypeOpt").val(),sortOrder:$("#sortOrderOpt").val(),Location:$("#LocationOpt").val(),Data:$("#DataOpt").val(),Format:$("#FormatOpt").val(),Detail:$("#DetailOpt").val(),Access:$("#AccessOpt").val()};n.TopicUserID===0||n.TopicUserID===null?NewuserOption(n):EditUserOption(n)}function NewUserLink(n,t){var r=$("#NewUserLink"),i=t.dataset.user;n==="Add"&&(r.find(".modal-title").text("New Link to user:  ->"+i),$("#modalOption1").prop("disabled",!1),$("#savebutton").show(),$("#CurrentUser").val(i),GetAllLinks())}function GetAllLinks(){$.ajax({url:"./GetAllLinks",type:"GET",dataType:"json",contentType:"application/json;",success:function(n){for(var i="",t=0;t<n.length;t++)i+='<option value ="'+n[t].Value+'">'+n[t].Text+"<\/option>";$("#NewLink").empty();$("#NewLink").append(i)}})}function SaveUserLink(){var n={TopicId:parseInt($("#NewLink").val()),Description:$("#Description").val(),Username:$("#CurrentUser").val()};$.ajax({url:"./Home/AddUserLinkAjax/",type:"POST",contentType:"application/json;",data:JSON.stringify({DTO_Link:n})}).done(function(){$("#NewUserLink").modal("hide");window.location.reload()}).fail(function(){alert("Error saving user data");$("#NewUserLink").modal("hide");window.location.reload()})}function CopyUser(){var t=$("#username").val(),n=$("#CopyTousername option:selected").text();n?$.ajax({url:"./Home/CopyUserLinks/",type:"POST",contentType:"application/json;",data:JSON.stringify({currentuser:t,copyTo:n}),success:function(){$("#myModal").modal("hide");window.location.reload()},error:function(){alert("Error saving user data")}}):($("#LinksWarning").prop("display","block"),$("#LinksWarning").show())}function ShowOptionDetail(n,t){var r=$("#OptionModal"),u=t.dataset.tuid,i=t.dataset.user;GetLinkById(u,i,function(t){n===2?(r.find(".modal-title").text("Editing Option: "+t[0].TopicUserID+" For user:"+i),$("#savebuttonO").text("YES"),$("#CloseBO").text("NO"),$("#DivDeleteText").show()):($("#DivDeleteText").hide(),n===1&&(r.find(".modal-title").text("Editing Option: ->"+t[0].TopicUserID+" For user:"+i),$("#modaloptionColumn1").prop("disabled",!0),$("#modaloptionColumn2").prop("disabled",!1),$("#savebuttonO").show()),n===0&&(r.find(".modal-title").text("Details for Option: "+t[0].TopicUserID+" - Username:"+i),$("#modaloptionColumn1").prop("disabled",!0),$("#modaloptionColumn1").prop("disabled",!0),$("#savebuttonO").hide()));$("#Type").val(t[0].Type);$("#Description").val(t[0].Description);$("#Location").val(t[0].Location);$("#Data").val(t[0].Data);$("#Format").val(t[0].Format);$("#TopicUserId").val(t[0].TopicUserID);$("#TopicId").val(t[0].TopicId);$("#SortOrder").val(t[0].SortOrder);$("#Datau").val(t[0].DataU);$("#VimsVisible").prop("checked",t[0].VimsVisible)})}function GetLinkById(n,t,i){$.ajax({url:"./GetLinkById",type:"GET",dataType:"json",contentType:"application/json;",data:{TopicUserId:n,UserName:t},success:function(n){i(n)},error:function(){alert("Error getting option data")}})}function SaveUserOption(){var n={TopicUserID:parseInt($("#TopicUserId").val()),TopicId:parseInt($("#TopicId").val()),Username:$("#CurrentUser").val(),SortOrder:$("#SortOrder").val(),DataU:$("#Datau").val()};OptionsAjax.type="POST";OptionsAjax.data=n;OptionsAjax.url=$("#savebuttonO").text()==="YES"?"./Home/DeleteUserLink/":"./Home/EditUserLink/";AjaxRequest(OptionsAjax);$("#OptionModal").modal("hide");window.location.reload()}function AjaxRequest(n){$.ajax({url:n.url,type:n.type,contentType:n.contentType,data:JSON.stringify({data:n.data}),success:function(){},error:function(n){alert(n.statusText)}})}function AjaxRequest(n,t){$.ajax({url:n.url,type:n.type,contentType:n.contentType,data:JSON.stringify({data:n.data}),success:function(n){t(n)},error:function(n){alert(n.statusText)}})}function LinkFunctions(n,t){var i=$("#LinkOptionsModal"),r;$("#modalfunctionsLinkC1").prop("disabled",!1);$("#modalfunctionsLinkC2").prop("disabled",!1);$("#saveLinkbutton").show();n===2?(i.find(".modal-title").text("New Link "),$("#topicid").val(""),$("#sortorder").val(""),$("#format").val(""),$("#detail").val(""),$("#type").val(""),$("#description").val(""),$("#data").val(""),$("#location").val("")):(r=t.dataset.topic,GetLinkDetails(r,function(t){n===1&&i.find(".modal-title").text("Editing Link: "+t[0].Description);n===0&&(i.find(".modal-title").text("Details for: "+t[0].Description),$("#modalfunctionsLinkC1").prop("disabled",!0),$("#modalfunctionsLinkC2").prop("disabled",!0),$("#saveLinkbutton").hide());$("#tid").val(t[0].TID);$("#topicid").val(t[0].TopicID);$("#sortorder").val(t[0].SortOrder.toString());$("#format").val(t[0].Format);$("#detail").val(t[0].Detail);$("#type").val(t[0].Type);$("#description").val(t[0].Description);$("#data").val(t[0].Data);$("#location").val(t[0].Location)}))}function GetLinkDetails(n,t){var i={TID:parseInt(n),TopicID:parseInt($("#topicid").val()),Type:$("#type").val(),SortOrder:$("#sortorder").val(),Description:$("#description").val(),Data:$("#data").val(),Location:$("#location").val(),Format:$("#format").val(),Detail:$("#detail").val()};OptionsAjax.url="./GetSingleLink";OptionsAjax.type="POST";OptionsAjax.data=i;AjaxRequest(OptionsAjax,t)}function SaveLinkChanges(){var n={TID:parseInt($("#tid").val()),TopicID:parseInt($("#topicid").val()),Type:$("#type").val(),SortOrder:$("#sortorder").val(),Description:$("#description").val(),Data:$("#data").val(),Location:$("#location").val(),Format:$("#format").val(),Detail:$("#detail").val()};n.TID===""||n.TopicID===""?Alert("New"):(OptionsAjax.url="./EditDataLink",OptionsAjax.type="POST",OptionsAjax.data=n,AjaxRequest(OptionsAjax),$("#LinkOptionsModal").modal("hide"),window.location.reload())}var OptionsAjax={url:"",type:"GET",contentType:"application/json",data:""};